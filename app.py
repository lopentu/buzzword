# -*-coding: utf-8 -*-
from flask import Flask, render_template
import coloredlogs
import requests
import logging
import json

coloredlogs.install(level=logging.DEBUG)

app = Flask(__name__)

# sample = '''[["都 是 最 高層 在 扛", "柯神", "想要 的 就是 讓 不 健康"], ["戰力 這麼 弱 ， 都 被", "柯神", "屌 打 蘋果 日報 小 S"], ["連結 ( 或短 網址 ) :", "柯神", "的確 不妥 剛 上任 的 時候"], ["不爽 再 重考 112 ) 的", "柯神", "來說 這 也 是 自己 人拉"], [". 名嘴 們 都 在 批評", "柯神", "腦子 只愛 錢 鍾小平 說 柯神"], ["柯神 腦子 只愛 錢 鍾小平 說", "柯神", "沒有 中心 思想 也 是 事實"], ["中心 思想 也 是 事實 今天", "柯神", "處理 前朝 爛攤子 很好 ， 但"], ["處理 到 最好 當選 的 時候", "柯神", "調子 拉到 最 高 不能 為了"], ["， 有傷 形象 還是 要 給", "柯神", "鼓勵 ， 他 最近 的 作為"], ["稱之柯屁 ， 而 八卦 版稱 之", "柯神", "， 而 非 真正 看待 政策"], ["符合 台灣 社會 實際 需要 。", "柯神", "文哲 講 得很 好 問題 不"], ["專家 可 幫忙 分析 嗎 ?", "柯神", "最近 真的 爭議 不斷 跑去 跟"], ["， 也 被 趕出 新潮流 了", "柯神", "敢 用 是 很 大膽 果然"], ["大膽 果然 也 吃到 一點 苦果", "柯神", "嘴巴 說 為 人民 ， 但"], ["覺得 該 改進 我 很 喜歡", "柯神", "， 但 他 做 事情 要"], ["92 共識 的 談話 新世代 的", "柯神", "幾乎 底定 是 MVP 得主 目前"], ["最近 超 流行 的 照像 姿勢", "柯神", "又 沒 講錯 這 都 可以"], ["比較 有 機會 最近 我 偶像", "柯神", "的 新聞 斗 被 貴婦 觀光團"], ["二郎神 太陽神 女 戰神 愛神 現代", "柯神", "柯批 柯瑞 武神 潘 武雄 卡神"], ["愛滋 危險 族群 套 一 句", "柯神", "說 的 這 是 抹黑 和"], [") 食安 問題 上 高總 跟", "柯神", "是 完全 相反 的 柯神 當初"], ["跟 柯神 是 完全 相反 的", "柯神", "當初 被 問到 頂新 ， 他"], ["我 跟 高總 不同 的 地方", "柯神", "也 算是 知人善任 ， 他 雖然"], ["只要 有 危害 或 牴觸 到", "柯神", "管 你 是 什麼 神 ，"], ["我 相信 只有 他 才能 單挑", "柯神", "其他 人 省省 吧 大家 安安"], ["意外 民生 社區 ㄟ 幹 支持", "柯神", "抓光 他們 拖光 他們 幹 楊伊湄"], ["幫他代 po 凜北 台東 小 神木", "柯神", "真是 神 ! 一頓 晚餐 的"], [". 完整 新聞 標題 : 壓垮", "柯神", "最後 一 根草 羅友志 ： 張夢麟"], ["自己 走人 ， 成為 「 壓垮", "柯神", "最後 一 根草 」 。 羅友"], ["拔 ！ ！ 張夢麟 就是 壓垮", "柯神", "最後 一 根草 」 ， 他"], ["下 不如 預期 ， 顯然 沒了", "柯神", "推手 光環 ， 自 神壇 上"], ["每況愈下 不如 預期 ， 顯然 沒了", "柯神", "推手 光環 ， 自 神壇 上"], [". 莊碩漢 ： 社會 造 「", "柯神", "」 反 造成 民主 政治 傷害"], ["的 情景 難怪 阿 不然 聽說", "柯神", "喜讀 歷史 懂 歷史 的 人"], ["這 也 不 是 第一 次", "柯神", "因為 翻譯 被 誤會 之前 賣"], ["也 是 莫名其妙 被 寫進 書中", "柯神", "的 翻譯 到底 怎麼 找 的"], ["也 脫黨 , 加上 一 人黨", "柯神", ", 三位一體 ! ! ! 燈燈"], ["條 外國 懶叫 台灣 現在 有", "柯神", "跟 賴神 兩 名 醫生 當"], ["買得起 6000 萬 的 房子 的", "柯神", "付不起 10 萬 ? 之前 柯神"], ["柯神 付不起 10 萬 ? 之前", "柯神", "不 是 才 說 過請 老師"], ["了 好幾萬 不放 在 眼裡 希望", "柯神", "能 以 首都 市長 的 高度"], ["大法官 們 去 商量 的 時候", "柯神", "不能 只是 做好 市政 要 拉高"], ["是 都 很 捧 賴神 、", "柯神", "嗎 ？ 醫師 治國 的 成績"], ["之星 剩紋 吧 不要 再 跟", "柯神", "打 口水 仗 講 難聽 的"], ["打 口水 仗 講 難聽 的", "柯神", "不 是 你 一 個 即將"], ["很 奇怪 以 目前 來說 就算", "柯神", "有 三 妻四妾 大家 根本 不會"], ["多久 ? 有 八卦 嗎 ?", "柯神", "講話 又 不經 大腦 了 而且"], ["年長 未婚 女生 來鞭 我 覺得", "柯神", "就是 沙豬 就是 皇民 這 真的"], ["不再 一窩峰 挺柯 文哲 ！ 「", "柯神", "現象 」 正 退燒 ？ 2015"], ["上 也 一 度 出現 「", "柯神", "現象 」 ， 不過 這 現象"]]'''
sample = '''[["完整 新聞 標題 : 憂心忡忡 ？", "喵星人", "的 八字 眉好冏 3 . 完整"], ["是 標題 常用 到 像 「", "喵星人", "」 等 字詞 內容 不外乎 是"], ["綜合 報導 大家 還 記得 之前", "喵星人", "Kido 挑戰 猜 盅 （ Shell"], ["番 的 一姐 呢 ? 膽大", "喵星人", "連 土地公 都 敢 踩 …"], ["土地公 都 敢 踩 … 蘋果", "喵星人", "到底 有多 大膽 ？ 看完 照片"], ["？ 毛揆 家 的 毛 小孩", "喵星人", "「 龍角散 」 曝光 2015 -"], ["是 收養 了 2 隻 流浪", "喵星人", "， 其中 一 隻 黑貓 「"], ["」 ； 由於 小孩 喜歡 「", "喵星人", "」 ， 陸陸續續 從路 邊 帶回"], ["同時 「 收服 」 2 隻", "喵星人", "拍 張照 ， 可 不 容易"], ["畜生 憑 什麼 當人 但是 汪星人", "喵星人", "一樣 是 把 畜生 當人 啊"], ["服務 ， 突然 出現 一 隻", "喵星人", "， 爬到 一 位 女性 遊客"], ["外電 報導 ） 「 我家 的", "喵星人", "到底 在 想 什麼 ？ 」"], ["報導 ) 真的 有 專門 給", "喵星人", "看 的 a 片 - ."], ["強者我朋友 說 這 是 開發 給", "喵星人", "排解 寂寞 不要 霸佔 鍵盤 的"], ["了 。 所以 我 就 送給", "喵星人", "啦 . . 真的 可以 觀察"], ["講到 搜尋 引擎 一定 要 講到", "喵星人", "是 一 種 奇特 的 生物"], ["生物 很多 女生 常 自比 是", "喵星人", "有時 會 故意 喵喵 叫 喜歡"], ["抽血 呀 ？ 有卦 嗎 ？", "喵星人", "： 幹 ！ 一 杯 星巴克"], ["的話 了 ！ 看似 特立獨行 的", "喵星人", "， 其實 也 非 常 樂於"], ["林蕙娟 ／ 綜合 報導 人類 與", "喵星人", "對 聲音 的 喜好 大 不同"], ["貓 舍 或 動物園 來 刺激", "喵星人", "的 感官 發展 。 想 聽聽"], ["流行 「 我們 已經 無法 阻止", "喵星人", "」 一 堆 貓咪 無法無天 的"], ["用 兩 人 慣用 的 「", "喵星人", "」 遮臉 ， 大方 曬愛 。"], ["O 星人 這 個 字眼 像是", "喵星人", ", 汪星人 不 曉得 還有 哪些"], ["。 科學家 尚未 完全 瞭解 為什麼", "喵星人", "特愛 盒子 ， 但 他們 有"], ["最受 歡迎 的 理論 認為 ，", "喵星人", "本能 受到 箱子 吸引 ， 是"], ["Vinke ） 最近 研究 躲藏 起來", "喵星人", "的 壓力 指 數 。 她"], ["貓咪 比 其他 沒有 箱子 的", "喵星人", "更 快 適應 新 環境 ，"], ["八卦 ? 傳說 中貓 的 報恩", "喵星人", "有 「 家政 婦 性格 」"], ["不過 ， 日本 有 一 隻", "喵星人", "的 興趣 竟然 是 打掃 ，"], ["網址 : 傳說 中貓 的 報恩", "喵星人", "有 「 家政 婦 性格 」"], ["見諒 ) 關鍵字 : 老貓 逗貓棒", "喵星人", "萌 新奇 寵物 小貓 最 新"], [". 完整 新聞 內文 : ▲", "喵星人", "「 阿龍 」 收到 包裹 。"], ["／ 綜合 報導 這 年頭 「", "喵星人", "」 越來越 不像 貓 了 ，"], ["網址 : 正宗 躲貓貓 ！ 以為", "喵星人", "失蹤 翻遍 全家 才 發現 睡"], ["叫 吵死 了 怎麼辦 辦公室 全是", "喵星人", "究竟 是 天堂 還是 地獄 ？"], ["？ 當 辦公室 裡 充滿 著", "喵星人", "， 最後 會 變成 什麼 模樣"], ["就 看 不到 我 ！ 」", "喵星人", "鬼鬼祟祟 想 偷溜 進 房間 3"], [": 國際 中心 ／ 綜合 報導", "喵星人", "的 「 鬼祟 行蹤 」 總是"], ["奴家 中 飼養 了 5 隻", "喵星人", "， 牠們 對於 聲音 的 分辨"], [". 完整 新聞 標題 : 5", "喵星人", "「 定格 」 不 動 過生日"], ["」 。 原文 網址 : 5", "喵星人", "「 定格 」 不 動 過生日"], ["2 . 完整 新聞 標題 :", "喵星人", "把 狗 肚子 當 枕頭 睡"], ["我 來 ！ 只見 這 隻", "喵星人", "躺 在 地上 ， 一 隻"], [". 乳頭 堅挺 下午 抓到 的", "喵星人", "放生 了 回到 乳頭 小魯 晚餐"], ["吃 美味 ， 人類 又 對", "喵星人", "好 ， 牠 才 變成 寵物"], ["吃 美味 ， 人類 又 對", "喵星人", "好 ， 牠 才 變成 寵物"], ["技 ， 才 有 辦法 瞭解", "喵星人", "獨一無二 的 生物 知識 及 求生"], ["全 世界 唯一 住在 水上 的", "喵星人", "。 這 艘 貓船 成立 於"], ["舊案 MG149 再 遭 檢調 調查", "喵星人", "平常 都 是 趴 著 或"], ["到底 為什麼 咧 ? ? 難道", "喵星人", "是 看 我 太 偉大 了"], ["以示 尊敬 嗎 ? ? 有沒有", "喵星人", "戰鬥 蹲姿 的 八卦 ? ?"], ["完整 新聞 標題 / 內文 :", "喵星人", "車禍 遭 「 腰斬 」 結果"], ["智慧型 存錢筒 ！ 」 、 「", "喵星人", "銀行 」 、 「 正宗 招財"], ["播過 一 個 會 滑板 的", "喵星人", "附一張 圖先 有 一部 美式 卡通"], ["哪 招阿 ? ? 怎會 這樣", "喵星人", "的 反撲 ? ? ? ?"], ["每 隻 一定 都 翻臉 有沒有", "喵星人", "不 讓 人 碰 尾巴 的"], ["人 碰 尾巴 的 八卦 補張", "喵星人", "30cm 的 照片 最近 看 一"], ["睡 在 蛇 蛇 旁邊 有沒有", "喵星人", "很 會 睡 的 卦 ?"], [": 39 不只 捲筒 衛生紙 讓", "喵星人", "著迷 ， 其實 一般 盒裝 的"], ["一段 影片 ， 小妹 家 的", "喵星人", "常常 半夜 不 睡覺 一直 看窗外"], ["內文 : 貓口 逃生 花栗鼠 痛扁", "喵星人", "1 . 媒體 來源 : NOWnews"], ["ETtoday 國際 中心 ／ 綜合 報導", "喵星人", "在 家 就 像 老大 一樣"], ["拳腳 相向 」 ， 連同 是", "喵星人", "的 同伴 也 慘遭 毒手 ！"], ["的 影片 中 ， 兩 隻", "喵星人", "坐 在 窗台 邊 ， 後面"], ["， 直說 影片 好 真實 ，", "喵星人", "就是 這麼 強硬 ， 不 陪"], ["完整 新聞 標題 / 內文 :", "喵星人", "無誤 小到 能塞 口袋 本魯正 出差"], ["什麼 都 可以 吵 只能 說", "喵星人", "太 厲害 了 已經 征服 占領"], ["你 來 做 就 超怪 ！", "喵星人", "一下 冷酷 一下 撒嬌 ， 成功"], ["？ 優柔寡斷 （ INDECISION ) ：", "喵星人", "想要 靠近 你 又 不 敢"], ["（ THE GOOD LIFE ) ：", "喵星人", "相當 喜歡 用 頭部 磨蹭 物體"], ["MEETING NEW PEOPLE ) ： 不少", "喵星人", "很 「 慢熟 」 ， 介紹"], ["突然 回去 騎士 的 八卦 ?", "喵星人", "的 魅力 獼猴 也 把持 不住"], ["人 把 自己 的 貓 稱做", "喵星人", "奇怪 貓 就 貓 為什麼 要"], ["貓 就 貓 為什麼 要 叫", "喵星人", "呢 貓奴 還 聽 的 懂"], ["呢 貓奴 還 聽 的 懂", "喵星人", "到底 是 什麼 東西 有沒有 喵星人"], ["喵星人 到底 是 什麼 東西 有沒有", "喵星人", "的 八卦 阿 喵 ~ ~"]]'''


@app.route('/')
def hello_world():
    # input_text = request.args.get('input_text')
    buzzword = '喵星人'
    return render_template('buzz.html', buzzword=buzzword, conc=json.loads(sample), method='get')


@app.route('/<word>')
def buzz_flex(word):
    url = 'http://localhost:12346/%s' % word
    jdata = requests.get(url).text
    dic = json.loads(jdata)
    return render_template('buzz.html', buzzword=word, conc=dic['conclist'], freq_by_month=json.dumps(dic['freq_by_month']), method='get')

if __name__ == '__main__':
    app.run(host='0.0.0.0', port=12345, debug=True)

